【問題分析】

第一問時LIS，動態規劃求解，第二問和第三問用網絡最大流解決。

【建模方法】

首先動態規劃求出F[i]，表示以第i位為開頭的最長上升序列的長度，求出最長上升序列長度K。

1、把序列每位i拆成兩個點<i.a>和<i.b>，從<i.a>到<i.b>連接一條容量為1的有向邊。
2、建立附加源S和匯T，如果序列第i位有F[i]=K，從S到<i.a>連接一條容量為1的有向邊。
3、如果F[i]=1，從<i.b>到T連接一條容量為1的有向邊。
4、如果j>i且A[i] < A[j]且F[j]+1=F[i]，從<i.b>到<j.a>連接一條容量為1的有向邊。

求網絡最大流，就是第二問的結果。把邊(<1.a>,<1.b>)(<N.a>,<N.b>)(S,<1.a>)(<N.b>,T)這四條邊的容量修改為無窮大，再求一次網絡最大流，就是第三問結果。

【建模分析】

上述建模方法是應用了一種分層圖的思想，把圖每個頂點i按照F[i]的不同分為了若干層，這樣圖中從S出發到T的任何一條路徑都是一個滿足條件的最長上升子序列。由於序列中每個點要不可重複地取出，需要把每個點拆分成兩個點。單位網絡的最大流就是增廣路的條數，所以最大流量就是第二問結果。第三問特殊地要求x1和xn可以重複使用，只需取消這兩個點相關邊的流量限制，求網絡最大流即可。